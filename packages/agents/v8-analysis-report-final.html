<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeQual PR Analysis Report - sindresorhus/ky #700</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #0969da;
            --success: #1a7f37;
            --warning: #9a6700;
            --danger: #d1242f;
            --info: #0550ae;
            --bg-light: #f6f8fa;
            --bg-white: #ffffff;
            --border: #d1d9e0;
            --text-primary: #1f2328;
            --text-secondary: #656d76;
            --text-muted: #8b949e;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background: var(--bg-light);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Header Section */
        .header {
            background: linear-gradient(135deg, #24292f 0%, #1a1f24 100%);
            color: white;
            padding: 40px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .header-meta {
            display: flex;
            gap: 30px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .header-meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
            opacity: 0.9;
        }
        
        .header-meta-item .icon {
            font-size: 1.2em;
        }
        
        /* Score Cards */
        .score-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .score-card {
            background: white;
            padding: 24px;
            border-radius: 8px;
            border: 1px solid var(--border);
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            text-align: center;
        }
        
        .score-card.primary {
            background: linear-gradient(135deg, #0969da 0%, #0550ae 100%);
            color: white;
            border: none;
        }
        
        .score-value {
            font-size: 3em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .score-label {
            font-size: 0.9em;
            opacity: 0.8;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .score-change {
            margin-top: 10px;
            font-size: 0.9em;
        }
        
        .score-change.positive {
            color: var(--success);
        }
        
        .score-change.negative {
            color: var(--danger);
        }
        
        /* Summary Section */
        .summary-section {
            background: white;
            padding: 30px;
            border-radius: 8px;
            border: 1px solid var(--border);
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        
        .summary-section h2 {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: var(--text-primary);
            font-weight: 600;
        }
        
        .impact-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .impact-item {
            padding: 15px;
            background: var(--bg-light);
            border-radius: 6px;
            border-left: 4px solid var(--primary);
        }
        
        .impact-item.fixed {
            border-left-color: var(--success);
        }
        
        .impact-item.new {
            border-left-color: var(--warning);
        }
        
        .impact-item.unchanged {
            border-left-color: var(--info);
        }
        
        /* Issues Section */
        .issues-section {
            background: white;
            padding: 30px;
            border-radius: 8px;
            border: 1px solid var(--border);
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        
        .issues-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .issues-header h2 {
            font-size: 1.5em;
            font-weight: 600;
        }
        
        .issues-filter {
            display: flex;
            gap: 10px;
        }
        
        .filter-btn {
            padding: 6px 12px;
            border: 1px solid var(--border);
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.2s;
        }
        
        .filter-btn:hover {
            background: var(--bg-light);
        }
        
        .filter-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        /* Issue Cards */
        .issue-card {
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.2s;
            background: white;
        }
        
        .issue-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transform: translateY(-2px);
        }
        
        .issue-card.fixed {
            opacity: 0.6;
            background: #f0fcf4;
        }
        
        .issue-card.new {
            background: #fffbf0;
            border-color: #fbbf24;
        }
        
        .issue-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        
        .issue-title {
            font-weight: 600;
            font-size: 1.1em;
            color: var(--text-primary);
            flex: 1;
            margin-right: 20px;
        }
        
        .issue-badges {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .badge {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .badge.severity-critical {
            background: #fecaca;
            color: #991b1b;
        }
        
        .badge.severity-high {
            background: #fed7aa;
            color: #c2410c;
        }
        
        .badge.severity-medium {
            background: #fef3c7;
            color: #a16207;
        }
        
        .badge.severity-low {
            background: #d1fae5;
            color: #065f46;
        }
        
        .badge.type-security {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .badge.type-performance {
            background: #fef3c7;
            color: #a16207;
        }
        
        .badge.type-quality {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .badge.type-dependencies {
            background: #e0e7ff;
            color: #3730a3;
        }
        
        .badge.type-testing {
            background: #f3e8ff;
            color: #6b21a8;
        }
        
        .badge.status-fixed {
            background: #d1fae5;
            color: #065f46;
        }
        
        .badge.status-new {
            background: #fed7aa;
            color: #c2410c;
        }
        
        .issue-location {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 15px 0;
            padding: 10px;
            background: var(--bg-light);
            border-radius: 6px;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
            font-size: 0.9em;
        }
        
        .issue-description {
            color: var(--text-secondary);
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .issue-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 15px;
            border-top: 1px solid var(--border);
        }
        
        .issue-impact {
            font-size: 0.9em;
            color: var(--text-secondary);
        }
        
        .issue-recommendation {
            padding: 12px;
            background: #f0f9ff;
            border-left: 3px solid var(--info);
            border-radius: 4px;
            margin-top: 10px;
            font-size: 0.95em;
        }
        
        /* Skills Section */
        .skills-section {
            background: white;
            padding: 30px;
            border-radius: 8px;
            border: 1px solid var(--border);
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        
        .skill-item {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .skill-label {
            width: 200px;
            font-weight: 600;
        }
        
        .skill-bar {
            flex: 1;
            height: 30px;
            background: var(--bg-light);
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }
        
        .skill-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--info));
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            color: white;
            font-weight: 600;
            font-size: 0.9em;
            transition: width 0.5s ease;
        }
        
        /* Recommendations */
        .recommendations {
            background: white;
            padding: 30px;
            border-radius: 8px;
            border: 1px solid var(--border);
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        
        .recommendation-card {
            padding: 20px;
            background: var(--bg-light);
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid var(--primary);
        }
        
        .recommendation-priority {
            display: inline-block;
            padding: 4px 10px;
            background: var(--danger);
            color: white;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        /* Footer */
        .footer {
            text-align: center;
            padding: 30px;
            color: var(--text-muted);
            font-size: 0.9em;
        }
        
        .footer a {
            color: var(--primary);
            text-decoration: none;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üîç CodeQual PR Analysis Report</h1>
            <div class="header-meta">
                <div class="header-meta-item">
                    <span class="icon">üì¶</span>
                    <span>sindresorhus/ky</span>
                </div>
                <div class="header-meta-item">
                    <span class="icon">#Ô∏è‚É£</span>
                    <span>PR #700</span>
                </div>
                <div class="header-meta-item">
                    <span class="icon">üë§</span>
                    <span>sindresorhus</span>
                </div>
                <div class="header-meta-item">
                    <span class="icon">üìÖ</span>
                    <span>2024-12-20</span>
                </div>
                <div class="header-meta-item">
                    <span class="icon">‚è±Ô∏è</span>
                    <span>Analysis Duration: 12.26s</span>
                </div>
            </div>
        </div>
        
        <!-- Score Cards -->
        <div class="score-cards">
            <div class="score-card primary">
                <div class="score-label">Overall Score</div>
                <div class="score-value">73/100</div>
                <div class="score-change negative">‚Üì 5 points from main</div>
            </div>
            <div class="score-card">
                <div class="score-label">Security Score</div>
                <div class="score-value">65</div>
                <div class="score-change">No change</div>
            </div>
            <div class="score-card">
                <div class="score-label">Performance</div>
                <div class="score-value">85</div>
                <div class="score-change positive">‚Üë 10 points</div>
            </div>
            <div class="score-card">
                <div class="score-label">Code Quality</div>
                <div class="score-value">70</div>
                <div class="score-change negative">‚Üì 8 points</div>
            </div>
            <div class="score-card">
                <div class="score-label">Test Coverage</div>
                <div class="score-value">68</div>
                <div class="score-change negative">‚Üì 12 points</div>
            </div>
        </div>
        
        <!-- Executive Summary -->
        <div class="summary-section">
            <h2>üìä Executive Summary</h2>
            <p>This PR introduces a retry mechanism with jitter for failed requests, addressing the thundering herd problem in the existing retry logic. While the performance improvement is significant, the PR introduces new code quality issues and lacks comprehensive test coverage.</p>
            
            <div class="impact-summary">
                <div class="impact-item fixed">
                    <strong>‚úÖ 1 Issue Fixed</strong>
                    <div>Performance: Retry logic optimization</div>
                </div>
                <div class="impact-item new">
                    <strong>‚ö†Ô∏è 3 New Issues</strong>
                    <div>Quality, Dependencies, Testing</div>
                </div>
                <div class="impact-item unchanged">
                    <strong>‚ÑπÔ∏è 6 Unchanged Issues</strong>
                    <div>2 Security, 1 Performance, 3 Quality</div>
                </div>
            </div>
        </div>
        
        <!-- Critical Issues -->
        <div class="issues-section">
            <div class="issues-header">
                <h2>üö® Critical & High Priority Issues</h2>
            </div>
            
            <!-- Security Issue 1 -->
            <div class="issue-card">
                <div class="issue-header">
                    <div class="issue-title">Missing input validation in request handler</div>
                    <div class="issue-badges">
                        <span class="badge severity-high">HIGH</span>
                        <span class="badge type-security">SECURITY</span>
                    </div>
                </div>
                <div class="issue-location">
                    üìç source/core/Ky.ts:145
                </div>
                <div class="issue-description">
                    The request handler accepts user input without proper validation, potentially allowing injection attacks. This could lead to XSS or other injection vulnerabilities.
                </div>
                <div class="issue-recommendation">
                    <strong>üí° Recommendation:</strong> Implement comprehensive input validation using a schema validator like Zod or Joi. Sanitize all user inputs before processing.
                </div>
                <div class="issue-footer">
                    <span class="issue-impact">Impact: Could compromise application security</span>
                    <span>CWE-20 | Confidence: 92%</span>
                </div>
            </div>
            
            <!-- Fixed Issue -->
            <div class="issue-card fixed">
                <div class="issue-header">
                    <div class="issue-title">‚úÖ FIXED: Inefficient retry logic causing delays</div>
                    <div class="issue-badges">
                        <span class="badge status-fixed">FIXED</span>
                        <span class="badge type-performance">PERFORMANCE</span>
                    </div>
                </div>
                <div class="issue-location">
                    üìç source/utils/retry.ts:23 ‚Üí Fixed in line 45
                </div>
                <div class="issue-description">
                    The pure exponential backoff without jitter was causing synchronized retries (thundering herd problem). This has been resolved by implementing exponential backoff with jitter.
                </div>
            </div>
            
            <!-- New Issue -->
            <div class="issue-card new">
                <div class="issue-header">
                    <div class="issue-title">üÜï Missing error handling in new retry logic</div>
                    <div class="issue-badges">
                        <span class="badge status-new">NEW</span>
                        <span class="badge severity-medium">MEDIUM</span>
                        <span class="badge type-quality">QUALITY</span>
                    </div>
                </div>
                <div class="issue-location">
                    üìç source/utils/retry.ts:67
                </div>
                <div class="issue-description">
                    The newly implemented retry mechanism does not handle all error cases, which could lead to unhandled promise rejections in edge scenarios.
                </div>
                <div class="issue-recommendation">
                    <strong>üí° Recommendation:</strong> Add comprehensive try-catch blocks and proper error propagation. Consider implementing a circuit breaker pattern for repeated failures.
                </div>
                <div class="issue-footer">
                    <span class="issue-impact">Impact: Could cause application crashes</span>
                    <span>Confidence: 83%</span>
                </div>
            </div>
            
            <!-- New Dependency Issue -->
            <div class="issue-card new">
                <div class="issue-header">
                    <div class="issue-title">üÜï Package lock file not updated</div>
                    <div class="issue-badges">
                        <span class="badge status-new">NEW</span>
                        <span class="badge severity-medium">MEDIUM</span>
                        <span class="badge type-dependencies">DEPENDENCIES</span>
                    </div>
                </div>
                <div class="issue-location">
                    üìç package.json:34
                </div>
                <div class="issue-description">
                    The package.json file has been modified but package-lock.json was not committed. This could cause version conflicts in CI/CD pipelines and other developer environments.
                </div>
                <div class="issue-recommendation">
                    <strong>üí° Recommendation:</strong> Run `npm install` and commit the updated package-lock.json file to ensure consistent dependency versions across all environments.
                </div>
                <div class="issue-footer">
                    <span class="issue-impact">Impact: Build failures in CI/CD</span>
                    <span>Confidence: 94%</span>
                </div>
            </div>
            
            <!-- Test Coverage Issue -->
            <div class="issue-card new">
                <div class="issue-header">
                    <div class="issue-title">üÜï Insufficient test coverage for retry logic</div>
                    <div class="issue-badges">
                        <span class="badge status-new">NEW</span>
                        <span class="badge severity-medium">MEDIUM</span>
                        <span class="badge type-testing">TESTING</span>
                    </div>
                </div>
                <div class="issue-location">
                    üìç source/utils/retry.ts:45
                </div>
                <div class="issue-description">
                    The new retry mechanism with jitter lacks comprehensive test cases. Edge cases, error scenarios, and the jitter algorithm itself are not covered by tests.
                </div>
                <div class="issue-recommendation">
                    <strong>üí° Recommendation:</strong> Add unit tests covering: successful retries, maximum retry limits, jitter distribution, error propagation, and timeout scenarios.
                </div>
                <div class="issue-footer">
                    <span class="issue-impact">Impact: Bugs may go undetected</span>
                    <span>Confidence: 89%</span>
                </div>
            </div>
        </div>
        
        <!-- Other Issues -->
        <div class="issues-section">
            <div class="issues-header">
                <h2>üìã Other Issues (4)</h2>
            </div>
            
            <div class="issue-card">
                <div class="issue-header">
                    <div class="issue-title">Sensitive data in error messages</div>
                    <div class="issue-badges">
                        <span class="badge severity-medium">MEDIUM</span>
                        <span class="badge type-security">SECURITY</span>
                    </div>
                </div>
                <div class="issue-location">
                    üìç source/errors.ts:78
                </div>
                <div class="issue-description">
                    Error responses may leak sensitive information about the system internals, which could aid attackers in reconnaissance.
                </div>
            </div>
            
            <div class="issue-card">
                <div class="issue-header">
                    <div class="issue-title">Complex function exceeds cognitive complexity</div>
                    <div class="issue-badges">
                        <span class="badge severity-medium">MEDIUM</span>
                        <span class="badge type-quality">QUALITY</span>
                    </div>
                </div>
                <div class="issue-location">
                    üìç source/core/constants.ts:8
                </div>
                <div class="issue-description">
                    Function normalizeRequestOptions has a cyclomatic complexity of 15, making it difficult to maintain and test.
                </div>
            </div>
        </div>
        
        <!-- Skills Assessment -->
        <div class="skills-section">
            <h2>üéØ Developer Skills Assessment</h2>
            
            <div class="skill-item">
                <div class="skill-label">Error Handling</div>
                <div class="skill-bar">
                    <div class="skill-fill" style="width: 65%;">65%</div>
                </div>
            </div>
            
            <div class="skill-item">
                <div class="skill-label">Performance Optimization</div>
                <div class="skill-bar">
                    <div class="skill-fill" style="width: 85%;">85%</div>
                </div>
            </div>
            
            <div class="skill-item">
                <div class="skill-label">Security Practices</div>
                <div class="skill-bar">
                    <div class="skill-fill" style="width: 60%;">60%</div>
                </div>
            </div>
            
            <div class="skill-item">
                <div class="skill-label">Testing</div>
                <div class="skill-bar">
                    <div class="skill-fill" style="width: 55%;">55%</div>
                </div>
            </div>
            
            <div class="skill-item">
                <div class="skill-label">Code Organization</div>
                <div class="skill-bar">
                    <div class="skill-fill" style="width: 70%;">70%</div>
                </div>
            </div>
        </div>
        
        <!-- Recommendations -->
        <div class="recommendations">
            <h2>üìå Priority Recommendations</h2>
            
            <div class="recommendation-card">
                <span class="recommendation-priority">HIGH PRIORITY</span>
                <h3>1. Address Security Vulnerabilities</h3>
                <p>Implement input validation for the request handler immediately. This is a critical security issue that could expose the application to attacks.</p>
            </div>
            
            <div class="recommendation-card">
                <span class="recommendation-priority">HIGH PRIORITY</span>
                <h3>2. Add Comprehensive Tests</h3>
                <p>Write unit tests for the new retry logic, covering all edge cases and error scenarios. Aim for at least 80% code coverage on new code.</p>
            </div>
            
            <div class="recommendation-card">
                <span class="recommendation-priority" style="background: var(--warning);">MEDIUM PRIORITY</span>
                <h3>3. Update Dependencies</h3>
                <p>Commit the package-lock.json file and update outdated dependencies to ensure build consistency across environments.</p>
            </div>
            
            <div class="recommendation-card">
                <span class="recommendation-priority" style="background: var(--info);">LOW PRIORITY</span>
                <h3>4. Refactor Complex Functions</h3>
                <p>Break down functions with high cyclomatic complexity into smaller, more manageable units for better maintainability.</p>
            </div>
        </div>
        
        <!-- Footer -->
        <div class="footer">
            <p>üìä Report generated by CodeQual Analysis System v8.0</p>
            <p>Model: openai/gpt-4o-mini | Cost: $0.01 | Cache: Enabled</p>
            <p>
                <a href="#">View Raw Data</a> ‚Ä¢ 
                <a href="#">Download PDF</a> ‚Ä¢ 
                <a href="#">Share Report</a>
            </p>
        </div>
    </div>
</body>
</html>