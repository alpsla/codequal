{
  "repositoryUrl": "https://github.com/sindresorhus/ky",
  "prNumber": 700,
  "mainBranchIssues": [
    {
      "id": "issue-1",
      "title": "Missing error handling for HTTP requests which could lead to unhandled promise rejections.",
      "description": "Missing error handling for HTTP requests which could lead to unhandled promise rejections.",
      "severity": "medium",
      "category": "code-quality",
      "location": {
        "file": "test/stream.ts",
        "line": 4
      },
      "file": "test/stream.ts",
      "line": 10,
      "locationMethod": "file-search",
      "locationConfidence": 70,
      "codeSnippet": "import {createHttpTestServer} from './helpers/create-http-test-server.js';"
    },
    {
      "id": "issue-2",
      "title": "Potential memory leak due to not properly closing HTTP connections in tests.",
      "description": "Potential memory leak due to not properly closing HTTP connections in tests.",
      "severity": "medium",
      "category": "code-quality",
      "location": {
        "file": "test/memory-leak.ts",
        "line": 8
      },
      "file": "test/memory-leak.ts",
      "line": 15,
      "locationMethod": "file-search",
      "locationConfidence": 70,
      "codeSnippet": "test('shared abort signal must not cause memory leak of input', async t => {"
    },
    {
      "id": "issue-3",
      "title": "Lack of input validation in the custom fetch function, which could lead to unexpected behavior.",
      "description": "Lack of input validation in the custom fetch function, which could lead to unexpected behavior.",
      "severity": "medium",
      "category": "code-quality",
      "location": {
        "file": "test/fetch.ts",
        "line": 9
      },
      "file": "test/fetch.ts",
      "line": 5,
      "locationMethod": "file-search",
      "locationConfidence": 70,
      "codeSnippet": "\tconst customFetch: typeof fetch = async input => {"
    },
    {
      "id": "issue-4",
      "title": "Unused variable `modifiedBody1` which could indicate incomplete code or refactoring issues.",
      "description": "Unused variable `modifiedBody1` which could indicate incomplete code or refactoring issues.",
      "severity": "medium",
      "category": "code-quality",
      "location": {
        "file": "test/hooks.ts",
        "line": 1
      },
      "file": "test/hooks.ts",
      "line": 150,
      "locationMethod": "file-search",
      "locationConfidence": 70,
      "codeSnippet": "import test from 'ava';"
    },
    {
      "id": "issue-5",
      "title": "Missing type annotations for parameters in several functions, reducing code clarity and increasing the risk of type errors.",
      "description": "Missing type annotations for parameters in several functions, reducing code clarity and increasing the risk of type errors.",
      "severity": "medium",
      "category": "code-quality",
      "location": {
        "file": "source/core/constants.ts",
        "line": 1
      },
      "file": "source/core/constants.ts",
      "line": 8,
      "locationMethod": "file-search",
      "locationConfidence": 70,
      "codeSnippet": "import type {Expect, Equal} from '@type-challenges/utils';"
    },
    {
      "id": "issue-6",
      "title": "Inefficient handling of retries without exponential backoff, which could lead to performance degradation under load.",
      "description": "Inefficient handling of retries without exponential backoff, which could lead to performance degradation under load.",
      "severity": "medium",
      "category": "code-quality",
      "location": {
        "file": "test/retry.ts",
        "line": 285
      },
      "file": "test/retry.ts",
      "line": 20,
      "locationMethod": "file-search",
      "locationConfidence": 70,
      "codeSnippet": "test('respect number of retries', async t => {"
    },
    {
      "id": "issue-7",
      "title": "Potential for denial of service due to lack of request rate limiting in the HTTP server.",
      "description": "Potential for denial of service due to lack of request rate limiting in the HTTP server.",
      "severity": "medium",
      "category": "code-quality",
      "location": {
        "file": "test/helpers/create-http-test-server.ts",
        "line": 30
      },
      "file": "test/helpers/create-http-test-server.ts",
      "line": 30
    },
    {
      "id": "issue-8",
      "title": "Inconsistent error messages for different types of HTTP errors, which could confuse developers during debugging.",
      "description": "Inconsistent error messages for different types of HTTP errors, which could confuse developers during debugging.",
      "severity": "medium",
      "category": "code-quality",
      "location": {
        "file": "source/core/constants.ts",
        "line": 16
      },
      "file": "source/core/constants.ts",
      "line": 18,
      "locationMethod": "file-search",
      "locationConfidence": 70,
      "codeSnippet": "\t\t\t\t// @ts-expect-error - Types are outdated."
    },
    {
      "id": "issue-9",
      "title": "Security vulnerability due to the lack of sanitization of user inputs in the searchParams option.",
      "description": "Security vulnerability due to the lack of sanitization of user inputs in the searchParams option.",
      "severity": "medium",
      "category": "code-quality",
      "location": {
        "file": "source/core/constants.ts",
        "line": 45
      },
      "file": "source/core/constants.ts",
      "line": 45
    },
    {
      "id": "issue-10",
      "title": "Lack of tests for edge cases in the retry mechanism, which may lead to untested scenarios in production.",
      "description": "Lack of tests for edge cases in the retry mechanism, which may lead to untested scenarios in production.",
      "severity": "medium",
      "category": "code-quality",
      "location": {
        "file": "test/retry.ts",
        "line": 3
      },
      "file": "test/retry.ts",
      "line": 60,
      "locationMethod": "file-search",
      "locationConfidence": 70,
      "codeSnippet": "import {createHttpTestServer} from './helpers/create-http-test-server.js';"
    }
  ],
  "prBranchIssues": [
    {
      "id": "issue-1",
      "title": "Missing error handling for the HTTP request in the POST method.",
      "description": "Missing error handling for the HTTP request in the POST method.",
      "severity": "medium",
      "category": "code-quality",
      "location": {
        "file": "test/stream.ts",
        "line": 4
      },
      "file": "test/stream.ts",
      "line": 27,
      "locationMethod": "file-search",
      "locationConfidence": 70,
      "codeSnippet": "import {createHttpTestServer} from './helpers/create-http-test-server.js';"
    },
    {
      "id": "issue-2",
      "title": "Potential race condition due to shared mutable state in tests.",
      "description": "Potential race condition due to shared mutable state in tests.",
      "severity": "medium",
      "category": "code-quality",
      "location": {
        "file": "test/browser.ts",
        "line": 79
      },
      "file": "test/browser.ts",
      "line": 79
    },
    {
      "id": "issue-3",
      "title": "Lack of input validation for request parameters which could lead to unexpected behavior.",
      "description": "Lack of input validation for request parameters which could lead to unexpected behavior.",
      "severity": "medium",
      "category": "code-quality",
      "location": {
        "file": "source/core/constants.ts",
        "line": 3
      },
      "file": "source/core/constants.ts",
      "line": 15,
      "locationMethod": "file-search",
      "locationConfidence": 70,
      "codeSnippet": "import {type RequestInitRegistry} from '../types/request.js';"
    },
    {
      "id": "issue-4",
      "title": "Possible denial of service due to unbounded retries on network errors.",
      "description": "Possible denial of service due to unbounded retries on network errors.",
      "severity": "medium",
      "category": "code-quality",
      "location": {
        "file": "test/retry.ts",
        "line": 285
      },
      "file": "test/retry.ts",
      "line": 35,
      "locationMethod": "file-search",
      "locationConfidence": 70,
      "codeSnippet": "test('respect number of retries', async t => {"
    },
    {
      "id": "issue-5",
      "title": "Inconsistent error handling in retry logic that could lead to unhandled promise rejections.",
      "description": "Inconsistent error handling in retry logic that could lead to unhandled promise rejections.",
      "severity": "medium",
      "category": "code-quality",
      "location": {
        "file": "test/hooks.ts",
        "line": 3
      },
      "file": "test/hooks.ts",
      "line": 15,
      "locationMethod": "file-search",
      "locationConfidence": 70,
      "codeSnippet": "import ky, {HTTPError} from '../source/index.js';"
    },
    {
      "id": "issue-6",
      "title": "Missing types for some functions which may lead to runtime errors.",
      "description": "Missing types for some functions which may lead to runtime errors.",
      "severity": "medium",
      "category": "code-quality",
      "location": {
        "file": "test/memory-leak.ts",
        "line": 5
      },
      "file": "test/memory-leak.ts",
      "line": 5
    },
    {
      "id": "issue-7",
      "title": "Lack of proper cleanup for server instances in tests which can cause resource leaks.",
      "description": "Lack of proper cleanup for server instances in tests which can cause resource leaks.",
      "severity": "medium",
      "category": "code-quality",
      "location": {
        "file": "test/main.ts",
        "line": 6
      },
      "file": "test/main.ts",
      "line": 10,
      "locationMethod": "file-search",
      "locationConfidence": 70,
      "codeSnippet": "import {createHttpTestServer} from './helpers/create-http-test-server.js';"
    },
    {
      "id": "issue-8",
      "title": "Use of deprecated or outdated packages that may pose security risks.",
      "description": "Use of deprecated or outdated packages that may pose security risks.",
      "severity": "medium",
      "category": "code-quality",
      "location": {
        "file": "package.json",
        "line": 20
      },
      "file": "package.json",
      "line": 20
    },
    {
      "id": "issue-9",
      "title": "Hardcoded timeout values that may not suit all environments, potentially leading to performance issues.",
      "description": "Hardcoded timeout values that may not suit all environments, potentially leading to performance issues.",
      "severity": "medium",
      "category": "code-quality",
      "location": {
        "file": "test/fetch.ts",
        "line": 45
      },
      "file": "test/fetch.ts",
      "line": 45
    },
    {
      "id": "issue-10",
      "title": "Potentially large memory usage due to the handling of big blobs without proper limits.",
      "description": "Potentially large memory usage due to the handling of big blobs without proper limits.",
      "severity": "medium",
      "category": "code-quality",
      "location": {
        "file": "test/stream.ts",
        "line": 3
      },
      "file": "test/stream.ts",
      "line": 55,
      "locationMethod": "file-search",
      "locationConfidence": 70,
      "codeSnippet": "import {createLargeBlob} from './helpers/create-large-file.js';"
    }
  ],
  "categorized": {
    "newIssues": [
      {
        "issue": {
          "id": "issue-1",
          "title": "Missing error handling for the HTTP request in the POST method.",
          "description": "Missing error handling for the HTTP request in the POST method.",
          "severity": "medium",
          "category": "code-quality",
          "location": {
            "file": "test/stream.ts",
            "line": 4
          },
          "file": "test/stream.ts",
          "line": 27,
          "locationMethod": "file-search",
          "locationConfidence": 70,
          "codeSnippet": "import {createHttpTestServer} from './helpers/create-http-test-server.js';"
        },
        "category": "new",
        "fingerprint": "test/stream.ts:0:code-quality:medium:xmpc0z:okf1dn",
        "confidence": 0.29999999999999993
      },
      {
        "issue": {
          "id": "issue-2",
          "title": "Potential race condition due to shared mutable state in tests.",
          "description": "Potential race condition due to shared mutable state in tests.",
          "severity": "medium",
          "category": "code-quality",
          "location": {
            "file": "test/browser.ts",
            "line": 79
          },
          "file": "test/browser.ts",
          "line": 79
        },
        "category": "new",
        "fingerprint": "test/browser.ts:75:code-quality:medium:ula9hx:",
        "confidence": 0.7
      },
      {
        "issue": {
          "id": "issue-4",
          "title": "Possible denial of service due to unbounded retries on network errors.",
          "description": "Possible denial of service due to unbounded retries on network errors.",
          "severity": "medium",
          "category": "code-quality",
          "location": {
            "file": "test/retry.ts",
            "line": 285
          },
          "file": "test/retry.ts",
          "line": 35,
          "locationMethod": "file-search",
          "locationConfidence": 70,
          "codeSnippet": "test('respect number of retries', async t => {"
        },
        "category": "new",
        "fingerprint": "test/retry.ts:285:code-quality:medium:p0dohh:hibkh8",
        "confidence": 0.29999999999999993
      },
      {
        "issue": {
          "id": "issue-5",
          "title": "Inconsistent error handling in retry logic that could lead to unhandled promise rejections.",
          "description": "Inconsistent error handling in retry logic that could lead to unhandled promise rejections.",
          "severity": "medium",
          "category": "code-quality",
          "location": {
            "file": "test/hooks.ts",
            "line": 3
          },
          "file": "test/hooks.ts",
          "line": 15,
          "locationMethod": "file-search",
          "locationConfidence": 70,
          "codeSnippet": "import ky, {HTTPError} from '../source/index.js';"
        },
        "category": "new",
        "fingerprint": "test/hooks.ts:0:code-quality:medium:z7hdt0:obyaxw",
        "confidence": 0.29999999999999993
      },
      {
        "issue": {
          "id": "issue-6",
          "title": "Missing types for some functions which may lead to runtime errors.",
          "description": "Missing types for some functions which may lead to runtime errors.",
          "severity": "medium",
          "category": "code-quality",
          "location": {
            "file": "test/memory-leak.ts",
            "line": 5
          },
          "file": "test/memory-leak.ts",
          "line": 5
        },
        "category": "new",
        "fingerprint": "test/memory-leak.ts:5:code-quality:medium:tvciar:",
        "confidence": 0.29999999999999993
      },
      {
        "issue": {
          "id": "issue-7",
          "title": "Lack of proper cleanup for server instances in tests which can cause resource leaks.",
          "description": "Lack of proper cleanup for server instances in tests which can cause resource leaks.",
          "severity": "medium",
          "category": "code-quality",
          "location": {
            "file": "test/main.ts",
            "line": 6
          },
          "file": "test/main.ts",
          "line": 10,
          "locationMethod": "file-search",
          "locationConfidence": 70,
          "codeSnippet": "import {createHttpTestServer} from './helpers/create-http-test-server.js';"
        },
        "category": "new",
        "fingerprint": "test/main.ts:5:code-quality:medium:qwv7zm:okf1dn",
        "confidence": 0.4
      },
      {
        "issue": {
          "id": "issue-8",
          "title": "Use of deprecated or outdated packages that may pose security risks.",
          "description": "Use of deprecated or outdated packages that may pose security risks.",
          "severity": "medium",
          "category": "code-quality",
          "location": {
            "file": "package.json",
            "line": 20
          },
          "file": "package.json",
          "line": 20
        },
        "category": "new",
        "fingerprint": "package.json:20:code-quality:medium:hnl9d8:",
        "confidence": 0.4
      },
      {
        "issue": {
          "id": "issue-9",
          "title": "Hardcoded timeout values that may not suit all environments, potentially leading to performance issues.",
          "description": "Hardcoded timeout values that may not suit all environments, potentially leading to performance issues.",
          "severity": "medium",
          "category": "code-quality",
          "location": {
            "file": "test/fetch.ts",
            "line": 45
          },
          "file": "test/fetch.ts",
          "line": 45
        },
        "category": "new",
        "fingerprint": "test/fetch.ts:45:code-quality:medium:b4ibq6:",
        "confidence": 0.29999999999999993
      },
      {
        "issue": {
          "id": "issue-10",
          "title": "Potentially large memory usage due to the handling of big blobs without proper limits.",
          "description": "Potentially large memory usage due to the handling of big blobs without proper limits.",
          "severity": "medium",
          "category": "code-quality",
          "location": {
            "file": "test/stream.ts",
            "line": 3
          },
          "file": "test/stream.ts",
          "line": 55,
          "locationMethod": "file-search",
          "locationConfidence": 70,
          "codeSnippet": "import {createLargeBlob} from './helpers/create-large-file.js';"
        },
        "category": "new",
        "fingerprint": "test/stream.ts:0:code-quality:medium:o802li:vbljs3",
        "confidence": 0.29999999999999993
      }
    ],
    "fixedIssues": [
      {
        "issue": {
          "id": "issue-1",
          "title": "Missing error handling for HTTP requests which could lead to unhandled promise rejections.",
          "description": "Missing error handling for HTTP requests which could lead to unhandled promise rejections.",
          "severity": "medium",
          "category": "code-quality",
          "location": {
            "file": "test/stream.ts",
            "line": 4
          },
          "file": "test/stream.ts",
          "line": 10,
          "locationMethod": "file-search",
          "locationConfidence": 70,
          "codeSnippet": "import {createHttpTestServer} from './helpers/create-http-test-server.js';"
        },
        "category": "fixed",
        "fingerprint": "test/stream.ts:0:code-quality:medium:1nn2hn:okf1dn",
        "confidence": 0.29999999999999993
      },
      {
        "issue": {
          "id": "issue-2",
          "title": "Potential memory leak due to not properly closing HTTP connections in tests.",
          "description": "Potential memory leak due to not properly closing HTTP connections in tests.",
          "severity": "medium",
          "category": "code-quality",
          "location": {
            "file": "test/memory-leak.ts",
            "line": 8
          },
          "file": "test/memory-leak.ts",
          "line": 15,
          "locationMethod": "file-search",
          "locationConfidence": 70,
          "codeSnippet": "test('shared abort signal must not cause memory leak of input', async t => {"
        },
        "category": "fixed",
        "fingerprint": "test/memory-leak.ts:5:code-quality:medium:u1t0od:lbrfld",
        "confidence": 0.29999999999999993
      },
      {
        "issue": {
          "id": "issue-3",
          "title": "Lack of input validation in the custom fetch function, which could lead to unexpected behavior.",
          "description": "Lack of input validation in the custom fetch function, which could lead to unexpected behavior.",
          "severity": "medium",
          "category": "code-quality",
          "location": {
            "file": "test/fetch.ts",
            "line": 9
          },
          "file": "test/fetch.ts",
          "line": 5,
          "locationMethod": "file-search",
          "locationConfidence": 70,
          "codeSnippet": "\tconst customFetch: typeof fetch = async input => {"
        },
        "category": "fixed",
        "fingerprint": "test/fetch.ts:5:code-quality:medium:j1qqha:7f49zw",
        "confidence": 0.29999999999999993
      },
      {
        "issue": {
          "id": "issue-4",
          "title": "Unused variable `modifiedBody1` which could indicate incomplete code or refactoring issues.",
          "description": "Unused variable `modifiedBody1` which could indicate incomplete code or refactoring issues.",
          "severity": "medium",
          "category": "code-quality",
          "location": {
            "file": "test/hooks.ts",
            "line": 1
          },
          "file": "test/hooks.ts",
          "line": 150,
          "locationMethod": "file-search",
          "locationConfidence": 70,
          "codeSnippet": "import test from 'ava';"
        },
        "category": "fixed",
        "fingerprint": "test/hooks.ts:0:code-quality:medium:kywua5:ki8c9m",
        "confidence": 0.29999999999999993
      },
      {
        "issue": {
          "id": "issue-5",
          "title": "Missing type annotations for parameters in several functions, reducing code clarity and increasing the risk of type errors.",
          "description": "Missing type annotations for parameters in several functions, reducing code clarity and increasing the risk of type errors.",
          "severity": "medium",
          "category": "code-quality",
          "location": {
            "file": "source/core/constants.ts",
            "line": 1
          },
          "file": "source/core/constants.ts",
          "line": 8,
          "locationMethod": "file-search",
          "locationConfidence": 70,
          "codeSnippet": "import type {Expect, Equal} from '@type-challenges/utils';"
        },
        "category": "fixed",
        "fingerprint": "source/core/constants.ts:0:code-quality:medium:bicj83:lcfzuy",
        "confidence": 0.20999999999999996
      },
      {
        "issue": {
          "id": "issue-6",
          "title": "Inefficient handling of retries without exponential backoff, which could lead to performance degradation under load.",
          "description": "Inefficient handling of retries without exponential backoff, which could lead to performance degradation under load.",
          "severity": "medium",
          "category": "code-quality",
          "location": {
            "file": "test/retry.ts",
            "line": 285
          },
          "file": "test/retry.ts",
          "line": 20,
          "locationMethod": "file-search",
          "locationConfidence": 70,
          "codeSnippet": "test('respect number of retries', async t => {"
        },
        "category": "fixed",
        "fingerprint": "test/retry.ts:285:code-quality:medium:cincru:hibkh8",
        "confidence": 0.29999999999999993
      },
      {
        "issue": {
          "id": "issue-7",
          "title": "Potential for denial of service due to lack of request rate limiting in the HTTP server.",
          "description": "Potential for denial of service due to lack of request rate limiting in the HTTP server.",
          "severity": "medium",
          "category": "code-quality",
          "location": {
            "file": "test/helpers/create-http-test-server.ts",
            "line": 30
          },
          "file": "test/helpers/create-http-test-server.ts",
          "line": 30
        },
        "category": "fixed",
        "fingerprint": "test/helpers/create-http-test-server.ts:30:code-quality:medium:ecx59k:",
        "confidence": 0.49
      },
      {
        "issue": {
          "id": "issue-9",
          "title": "Security vulnerability due to the lack of sanitization of user inputs in the searchParams option.",
          "description": "Security vulnerability due to the lack of sanitization of user inputs in the searchParams option.",
          "severity": "medium",
          "category": "code-quality",
          "location": {
            "file": "source/core/constants.ts",
            "line": 45
          },
          "file": "source/core/constants.ts",
          "line": 45
        },
        "category": "fixed",
        "fingerprint": "source/core/constants.ts:45:code-quality:medium:6sv5q5:",
        "confidence": 0.29999999999999993
      },
      {
        "issue": {
          "id": "issue-10",
          "title": "Lack of tests for edge cases in the retry mechanism, which may lead to untested scenarios in production.",
          "description": "Lack of tests for edge cases in the retry mechanism, which may lead to untested scenarios in production.",
          "severity": "medium",
          "category": "code-quality",
          "location": {
            "file": "test/retry.ts",
            "line": 3
          },
          "file": "test/retry.ts",
          "line": 60,
          "locationMethod": "file-search",
          "locationConfidence": 70,
          "codeSnippet": "import {createHttpTestServer} from './helpers/create-http-test-server.js';"
        },
        "category": "fixed",
        "fingerprint": "test/retry.ts:0:code-quality:medium:rz6hrz:okf1dn",
        "confidence": 0.29999999999999993
      }
    ],
    "unchangedIssues": [
      {
        "issue": {
          "id": "issue-3",
          "title": "Lack of input validation for request parameters which could lead to unexpected behavior.",
          "description": "Lack of input validation for request parameters which could lead to unexpected behavior.",
          "severity": "medium",
          "category": "code-quality",
          "location": {
            "file": "source/core/constants.ts",
            "line": 3
          },
          "file": "source/core/constants.ts",
          "line": 15,
          "locationMethod": "file-search",
          "locationConfidence": 70,
          "codeSnippet": "import {type RequestInitRegistry} from '../types/request.js';"
        },
        "category": "unchanged",
        "fingerprint": "source/core/constants.ts:0:code-quality:medium:xxcjqr:2h2m97",
        "confidence": 0.91
      }
    ],
    "summary": {
      "totalNew": 9,
      "totalFixed": 9,
      "totalUnchanged": 1,
      "netImpact": 0,
      "prQualityScore": 35
    },
    "recommendations": [
      "✅ Great work! This PR fixes 9 existing issue(s)",
      "🔴 Significant issues detected. Consider revising this PR."
    ]
  },
  "metadata": {
    "analysisDate": "2025-08-26T03:01:13.706Z",
    "mainBranchAnalysisDuration": 12.5,
    "prBranchAnalysisDuration": 11.2,
    "totalDuration": 23.7,
    "modelUsed": "dynamic-selection",
    "iterationsPerBranch": 3,
    "tokensUsed": 0
  }
}